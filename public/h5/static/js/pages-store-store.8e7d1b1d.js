(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-store-store"],{"2fd2":function(t,e,i){"use strict";var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.$imgurl?i("div",[i("v-uni-view",{staticClass:"toubu"},[i("v-uni-image",{staticStyle:{width:"36rpx",height:"36rpx",margin:"22rpx 10rpx 0 0",float:"left"},attrs:{mode:"scaleToFill",src:t.footer.i_add}}),t._v("当前城市："+t._s(t.currentCity)),1==t.storeShow?i("v-uni-navigator",{staticClass:"qiehuan",attrs:{url:"/pages/switchcity/switchcity?c="+t.currentCity}},[t._v("[切换]")]):t._e(),i("v-uni-view",{staticClass:"toubu_r"},[t._v("共有"),i("span",[t._v(t._s(t.storenum))]),t._v("个"+t._s(t.title))])],1),1==t.search?i("v-uni-view",{staticStyle:{"margin-top":"90rpx"}},[i("v-uni-form",{staticClass:"search",style:"background:"+t.color,attrs:{"report-submit":"true"},on:{submit:function(e){arguments[0]=e=t.$handleEvent(e),t.searchR.apply(void 0,arguments)}}},[i("v-uni-input",{staticClass:"sear_input",attrs:{name:"keywords","placeholder-class":"search_t",placeholder:"请输入关键词","confirm-type":"search"},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.searchR.apply(void 0,arguments)},input:function(e){arguments[0]=e=t.$handleEvent(e),t.serachInput.apply(void 0,arguments)}}})],1)],1):t._e(),0==t.search?i("v-uni-view",{staticStyle:{"margin-top":"100rpx"}}):t._e(),i("v-uni-view",{staticStyle:{"background-color":"#ffffff"}},[t.storelist.length>0?t._l(t.storelist,function(e,a){return i("v-uni-view",{key:e.kms,staticClass:"list_store"},[i("v-uni-view",{staticClass:"thumb"},[i("v-uni-image",{attrs:{mode:"aspectFill",src:e.logo}})],1),i("v-uni-view",{staticClass:"title"},[i("v-uni-view",{staticClass:"biaots"},[t._v(t._s(e.title))]),i("v-uni-view",{staticClass:"ccls"},[i("v-uni-image",{attrs:{mode:"scaleToFill",src:t.footer.i_time}}),t._v(t._s(e.times))],1),i("v-uni-view",{staticClass:"ccls",attrs:{"data-title":e.title,"data-lat":e.lat,"data-lon":e.lon,"data-address":e.province+e.city+e.country},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openMap.apply(void 0,arguments)}}},[i("v-uni-image",{attrs:{mode:"scaleToFill",src:t.footer.i_add}}),t._v(t._s(e.country))],1)],1),i("v-uni-view",{staticClass:"dianh"},[i("v-uni-view",[i("v-uni-image",{attrs:{src:t.$imgurl+"u_tel.png","data-index":e.tel},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.dianPhoneCall.apply(void 0,arguments)}}})],1),i("v-uni-view",{staticClass:"shukd"},[e.kms>12800?[t._v("定位失败")]:[t._v(t._s(e.kms)+"km")]],2)],1)],1)}):[i("v-uni-image",{staticClass:"pageNotice",attrs:{src:t.$imgurl+"notice.png"}}),i("v-uni-view",{staticClass:"pageNoticeT"},[t._v("当前城市暂无门店，请切换其他城市")])]],2),1==t.baseinfo.tabbar_t?i("copyright",{attrs:{baseinfo:t.baseinfo}}):t._e(),i("myfooter",{attrs:{page_signs:t.page_signs,baseinfo:t.baseinfo}})],1):t._e()},n=[];i.d(e,"a",function(){return a}),i.d(e,"b",function(){return n})},"689f":function(t,e,i){"use strict";var a=i("f25d"),n=i.n(a);n.a},"8d0f":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("386d");var a=i("7131"),n=i("af3c"),o={data:function(){return{$imgurl:this.$imgurl,page_signs:"/pages/store/store",storelist:[],baseinfo:[],footer:{i_tel:this.$imgurl+"i_tel.png",i_add:this.$imgurl+"i_add.png",i_time:this.$imgurl+"i_time.png",i_view:this.$imgurl+"i_view.png",close:this.$imgurl+"c.png",v_ico:this.$imgurl+"p.png"},currentCity:"",searchtitle:"",title:"",city:"",storeShow:0,storenum:0,search:0}},onPullDownRefresh:function(t){this.getStoreConf(),this.searchtitle="",uni.stopPullDownRefresh()},onLoad:function(t){var e=this,i=this,n=t.city;n&&(i.city=n);var o=0;t.fxsid&&(o=t.fxsid,i.fxsid=t.fxsid),this._baseMin(this),a.h5login(o,function(){e.getStoreConf()})},onShareAppMessage:function(){var t=this;return{title:t.title+"展示 -"+t.baseinfo.name}},methods:{openMap:function(t){uni.openLocation({latitude:t.currentTarget.dataset.lat,longitude:t.currentTarget.dataset.lon,name:t.currentTarget.dataset.title,address:t.currentTarget.dataset.address,scale:22})},redirectto:function(t){var e=t.currentTarget.dataset.link,i=t.currentTarget.dataset.linktype;this._redirectto(e,i)},getStoreConf:function(){var t=this;uni.request({url:t.$baseurl+"doPagestoreConf",data:{uniacid:t.$uniacid},success:function(e){if(e.data.data.mapkey)var i=e.data.data.mapkey;else i="6DYBZ-GN6W3-45I3C-Y2A4Q-YRIAS-YFBP3";t.search=e.data.data.search,t.title=e.data.data.title,t.storeShow=e.data.data.flag,uni.setNavigationBarTitle({title:t.title+"展示"});var a=new n({key:i});0==e.data.data.flag?uni.getLocation({success:function(e){var i=e.latitude,n=e.longitude;a.reverseGeocoder({location:{latitude:i,longitude:n},success:function(e){t.currentCity=e["result"]["address_component"]["city"]}}),t.getListAll(n,i)},fail:function(){t.getListAll()}}):uni.getLocation({success:function(e){var i=e.latitude,n=e.longitude;a.reverseGeocoder({location:{latitude:i,longitude:n},success:function(e){var a=t.city;a?(t.currentCity=a,t.getList(n,i,a)):(t.currentCity=e["result"]["address_component"]["city"],t.getList(n,i,e["result"]["address_component"]["city"]))}})}}),uni.hideNavigationBarLoading(),uni.stopPullDownRefresh()},fail:function(t){}})},getList:function(t,e,i){var a=this;uni.request({url:a.$baseurl+"doPagestoreNew",data:{uniacid:a.$uniacid,lon:t,lat:e,currentCity:i},success:function(t){a.storelist=t.data.data,a.storenum=t.data.data.length,uni.hideNavigationBarLoading(),uni.stopPullDownRefresh()},fail:function(t){}})},getListAll:function(t,e){var i=this;uni.request({url:i.$baseurl+"doPagestore",data:{lon:t,lat:e,uniacid:i.$uniacid},success:function(t){i.storelist=t.data.data.list,i.storenum=t.data.data.num,uni.hideNavigationBarLoading(),uni.stopPullDownRefresh()},fail:function(t){}})},dianPhoneCall:function(t){var e=t.currentTarget.dataset.index;uni.makePhoneCall({phoneNumber:e})},makePhoneCall:function(t){var e=this,i=e.baseinfo.tel;uni.makePhoneCall({phoneNumber:i})},makePhoneCallB:function(t){var e=this,i=e.baseinfo.tel_b;uni.makePhoneCall({phoneNumber:i})},mycoupp:function(){uni.redirectTo({url:"/pages/mycoupon/mycoupon"})},serachInput:function(t){var e=this;e.searchtitle=t.detail.value},searchR:function(){var t=this,e=e,i=i,a=t.searchtitle;a?uni.request({url:t.$baseurl+"dopagestore",data:{uniacid:t.$uniacid,lon:i,lat:e,keyword:a},success:function(e){t.storelist=e.data.data.list,t.storenum=e.data.data.num,uni.hideNavigationBarLoading(),uni.stopPullDownRefresh()},fail:function(t){}}):uni.showModal({title:"提醒",content:"请输入搜索关键字！",showCancel:!1})},gesinco:function(){var t=this;t.diplay=res.data.data.flag;var e=0;1==res.flag?e++:e--;for(e=0;e<res.data.length;e++)res.data[e].cmd}}};e.default=o},"8e5e":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".toubu[data-v-41408b90]{position:fixed;width:100%;height:%?80?%;line-height:%?80?%;top:0;box-sizing:border-box;z-index:1000;padding:0 2%;background-color:#fff}.toubu .qiehuan[data-v-41408b90]{color:#bbb;display:inline}.toubu_r[data-v-41408b90]{float:right}.toubu_r span[data-v-41408b90]{color:#f38539}.list_store[data-v-41408b90]{border-bottom:1px solid #eee;padding:%?20?%;height:%?140?%;overflow:hidden}.thumb[data-v-41408b90]{float:left}.thumb uni-image[data-v-41408b90]{width:%?140?%;height:%?140?%;display:block;border-radius:%?90?%;border:%?2?% solid #eee;padding:%?2?%}.title[data-v-41408b90]{float:left;width:50%;margin-left:%?20?%;padding-top:%?2?%}.biaots[data-v-41408b90]{font-size:%?28?%;color:#000;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ccls[data-v-41408b90]{font-size:%?24?%;color:#888;margin-top:%?10?%;height:%?40?%;overflow:hidden}.ccls uni-image[data-v-41408b90]{width:%?28?%;height:%?28?%;float:left;opacity:.6;margin:%?5?% %?6?% 0 0}.dianh[data-v-41408b90]{float:right;vertical-align:top;text-align:center;width:20%;padding-top:%?10?%}.dianh uni-image[data-v-41408b90]{width:%?70?%;height:%?70?%}.shukd[data-v-41408b90]{font-size:%?24?%;padding-top:%?8?%}\n\n",""])},aa75:function(t,e,i){"use strict";i.r(e);var a=i("2fd2"),n=i("e1a0");for(var o in n)"default"!==o&&function(t){i.d(e,t,function(){return n[t]})}(o);i("689f");var r=i("2877"),s=Object(r["a"])(n["default"],a["a"],a["b"],!1,null,"41408b90",null);e["default"]=s.exports},af3c:function(t,e,i){"use strict";var a=i("288e");i("28a5");var n=a(i("85f2")),o=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),(0,n.default)(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}();function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s={KEY_ERR:311,KEY_ERR_MSG:"key格式错误",PARAM_ERR:310,PARAM_ERR_MSG:"请求参数信息有误",SYSTEM_ERR:600,SYSTEM_ERR_MSG:"系统错误",WX_ERR_CODE:1e3,WX_OK_CODE:200},u="https://apis.map.qq.com/ws/",l=u+"place/v1/search",c=u+"place/v1/suggestion",d=u+"geocoder/v1/",f=u+"district/v1/list",g=u+"district/v1/getchildren",p=u+"distance/v1/",v={location2query:function(t){if("string"==typeof t)return t;for(var e="",i=0;i<t.length;i++){var a=t[i];e&&(e+=";"),a.location&&(e=e+a.location.lat+","+a.location.lng),a.latitude&&a.longitude&&(e=e+a.latitude+","+a.longitude)}return e},getWXLocation:function(t,e,i){wx.getLocation({type:"gcj02",success:t,fail:e,complete:i})},getLocationParam:function(t){if("string"==typeof t){var e=t.split(",");t=2===e.length?{latitude:t.split(",")[0],longitude:t.split(",")[1]}:{}}return t},polyfillParam:function(t){t.success=t.success||function(){},t.fail=t.fail||function(){},t.complete=t.complete||function(){}},checkParamKeyEmpty:function(t,e){if(!t[e]){var i=this.buildErrorConfig(s.PARAM_ERR,s.PARAM_ERR_MSG+e+"参数格式有误");return t.fail(i),t.complete(i),!0}return!1},checkKeyword:function(t){return!this.checkParamKeyEmpty(t,"keyword")},checkLocation:function(t){var e=this.getLocationParam(t.location);if(!e||!e.latitude||!e.longitude){var i=this.buildErrorConfig(s.PARAM_ERR,s.PARAM_ERR_MSG+" location参数格式有误");return t.fail(i),t.complete(i),!1}return!0},buildErrorConfig:function(t,e){return{status:t,message:e}},buildWxRequestConfig:function(t,e){var i=this;return e.header={"content-type":"application/json"},e.method="GET",e.success=function(e){var i=e.data;0===i.status?t.success(i):t.fail(i)},e.fail=function(e){e.statusCode=s.WX_ERR_CODE,t.fail(i.buildErrorConfig(s.WX_ERR_CODE,result.errMsg))},e.complete=function(e){var a=+e.statusCode;switch(a){case s.WX_ERR_CODE:t.complete(i.buildErrorConfig(s.WX_ERR_CODE,e.errMsg));break;case s.WX_OK_CODE:var n=e.data;0===n.status?t.complete(n):t.complete(i.buildErrorConfig(n.status,n.message));break;default:t.complete(i.buildErrorConfig(s.SYSTEM_ERR,s.SYSTEM_ERR_MSG))}},e},locationProcess:function(t,e,i,a){var n=this;if(i=i||function(e){e.statusCode=s.WX_ERR_CODE,t.fail(n.buildErrorConfig(s.WX_ERR_CODE,e.errMsg))},a=a||function(e){e.statusCode==s.WX_ERR_CODE&&t.complete(n.buildErrorConfig(s.WX_ERR_CODE,e.errMsg))},t.location){if(n.checkLocation(t)){var o=v.getLocationParam(t.location);e(o)}}else n.getWXLocation(e,i,a)}},h=function(){function t(e){if(r(this,t),!e.key)throw Error("key值不能为空");this.key=e.key}return o(t,[{key:"search",value:function(t){var e=this;if(t=t||{},v.polyfillParam(t),v.checkKeyword(t)){var i={keyword:t.keyword,orderby:t.orderby||"_distance",page_size:t.page_size||10,page_index:t.page_index||1,output:"json",key:e.key};t.address_format&&(i.address_format=t.address_format),t.filter&&(i.filter=t.filter);var a=t.distance||"1000",n=t.auto_extend||1,o=function(e){i.boundary="nearby("+e.latitude+","+e.longitude+","+a+","+n+")",wx.request(v.buildWxRequestConfig(t,{url:l,data:i}))};v.locationProcess(t,o)}}},{key:"getSuggestion",value:function(t){var e=this;if(t=t||{},v.polyfillParam(t),v.checkKeyword(t)){var i={keyword:t.keyword,region:t.region||"全国",region_fix:t.region_fix||0,policy:t.policy||0,output:"json",key:e.key};wx.request(v.buildWxRequestConfig(t,{url:c,data:i}))}}},{key:"reverseGeocoder",value:function(t){var e=this;t=t||{},v.polyfillParam(t);var i={coord_type:t.coord_type||5,get_poi:t.get_poi||0,output:"json",key:e.key};t.poi_options&&(i.poi_options=t.poi_options);var a=function(e){i.location=e.latitude+","+e.longitude,wx.request(v.buildWxRequestConfig(t,{url:d,data:i}))};v.locationProcess(t,a)}},{key:"geocoder",value:function(t){var e=this;if(t=t||{},v.polyfillParam(t),!v.checkParamKeyEmpty(t,"address")){var i={address:t.address,output:"json",key:e.key};wx.request(v.buildWxRequestConfig(t,{url:d,data:i}))}}},{key:"getCityList",value:function(t){var e=this;t=t||{},v.polyfillParam(t);var i={output:"json",key:e.key};wx.request(v.buildWxRequestConfig(t,{url:f,data:i}))}},{key:"getDistrictByCityId",value:function(t){var e=this;if(t=t||{},v.polyfillParam(t),!v.checkParamKeyEmpty(t,"id")){var i={id:t.id||"",output:"json",key:e.key};wx.request(v.buildWxRequestConfig(t,{url:g,data:i}))}}},{key:"calculateDistance",value:function(t){var e=this;if(t=t||{},v.polyfillParam(t),!v.checkParamKeyEmpty(t,"to")){var i={mode:t.mode||"walking",to:v.location2query(t.to),output:"json",key:e.key},a=function(e){i.from=e.latitude+","+e.longitude,wx.request(v.buildWxRequestConfig(t,{url:p,data:i}))};t.from&&(t.location=t.from),v.locationProcess(t,a)}}}]),t}();t.exports=h},e1a0:function(t,e,i){"use strict";i.r(e);var a=i("8d0f"),n=i.n(a);for(var o in a)"default"!==o&&function(t){i.d(e,t,function(){return a[t]})}(o);e["default"]=n.a},f25d:function(t,e,i){var a=i("8e5e");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=i("4f06").default;n("52ff5eb4",a,!0,{sourceMap:!1,shadowMode:!1})}}]);