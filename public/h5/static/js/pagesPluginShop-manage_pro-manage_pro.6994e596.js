(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagesPluginShop-manage_pro-manage_pro"],{"0c06":function(t,a,e){a=t.exports=e("2350")(!1),a.push([t.i,'uni-page-body[data-v-69c11954]{background:#f6f6f6}.container[data-v-69c11954]{padding:%?30?%;font-size:%?26?%}.formtitle[data-v-69c11954]{color:#000;font-weight:700;margin-bottom:%?20?%}.formcon[data-v-69c11954]{margin-bottom:%?30?%}.formcon[data-v-69c11954]:after{clear:both;content:"";display:block}.picker[data-v-69c11954],uni-input[data-v-69c11954]{margin:0}uni-input[data-v-69c11954]{padding:%?10?% %?20?%}.picker[data-v-69c11954]{padding:0 %?20?%}.textarea[data-v-69c11954]{border:solid 1px #eee;background:#fff;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;padding:%?20?%}.image[data-v-69c11954]{width:%?140?%;height:%?140?%;float:left;margin-right:%?30?%;overflow:hidden;border:%?2?% solid #fff;position:relative}.image uni-image[data-v-69c11954]{width:100%;height:100%}uni-button[data-v-69c11954]{background:#09bb07;color:#fff}.delimg[data-v-69c11954]{position:absolute;right:0;top:0;background:#e33;color:#fff;font-size:%?22?%;padding:%?2?% %?6?%}.hide[data-v-69c11954]{display:none}uni-video[data-v-69c11954]{width:%?400?%;height:%?300?%;float:left}.chooseVideo[data-v-69c11954]{float:left;margin-left:%?30?%;background:#e33;color:#fff;font-size:%?22?%;padding:%?2?% %?6?%}\r\nbody.?%PAGE?%[data-v-69c11954]{background:#f6f6f6}',""])},"27f6":function(t,a,e){"use strict";e.r(a);var i=e("d2a7"),n=e.n(i);for(var o in i)"default"!==o&&function(t){e.d(a,t,function(){return i[t]})}(o);a["default"]=n.a},4969:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return t.$imgurl?e("v-uni-view",{staticClass:"container"},[e("v-uni-form",{on:{submit:function(a){a=t.$handleEvent(a),t.formSubmit(a)}}},[e("v-uni-view",{staticClass:"row formtitle"},[t._v("排序")]),e("v-uni-view",{staticClass:"row formcon"},[e("v-uni-input",{staticClass:"m-wrap placeholder-no-fix",attrs:{type:"text",placeholder:"序号越大越靠前，不填为0",name:"num",value:t.proInfo.num?t.proInfo.num:0}})],1),e("v-uni-view",{staticClass:"row formtitle"},[t._v("是否上架")]),e("v-uni-radio-group",{staticClass:"radio-group formcon",attrs:{name:"flag"}},[e("v-uni-label",{staticClass:"radio"},[e("v-uni-radio",{attrs:{value:"1",checked:1==t.proInfo.flag?"true":""}}),t._v("上架")],1),e("v-uni-label",{staticClass:"radio",staticStyle:{"margin-left":"30rpx"}},[e("v-uni-radio",{attrs:{value:"2",checked:2==t.proInfo.flag?"true":""}}),t._v("下架")],1)],1),e("v-uni-view",{staticClass:"row formtitle"},[t._v("所属栏目")]),e("v-uni-view",{staticClass:"row formcon"},[e("v-uni-view",{staticClass:"section"},[e("v-uni-picker",{attrs:{value:t.index,range:t.cateinfo},on:{change:function(a){a=t.$handleEvent(a),t.bindPickerChange(a)}}},[e("v-uni-view",{staticClass:"picker"},[t._v("当前选择："+t._s(t.cateinfo[t.index]))])],1)],1)],1),e("v-uni-view",{staticClass:"row formtitle"},[t._v("标题")]),e("v-uni-view",{staticClass:"row formcon"},[t.proInfo.title?[e("v-uni-input",{staticClass:"m-wrap placeholder-no-fix",attrs:{type:"text",placeholder:"标题",name:"title",value:t.proInfo.title}})]:[e("v-uni-input",{staticClass:"m-wrap placeholder-no-fix",attrs:{type:"text",placeholder:"标题",name:"title"}})]],2),e("v-uni-view",{staticClass:"row formtitle"},[t._v("缩略图")]),e("v-uni-view",{staticClass:"image_content formcon"},[t.thumb?[t.hideAdd1?[e("v-uni-view",{staticClass:"image"},[e("v-uni-image",{staticClass:"moment_img",attrs:{src:t.proInfo.thumb},on:{click:function(a){a=t.$handleEvent(a),t.choosethumb(a)}}}),e("v-uni-view",{staticClass:"delimg",attrs:{"data-id":t.key},on:{click:function(a){a=t.$handleEvent(a),t.choosethumb(a)}}},[t._v("更换")])],1)]:t._e(),[e("v-uni-view",{staticClass:"image"},[e("v-uni-image",{staticClass:"moment_img",attrs:{src:t.thumb},on:{click:function(a){a=t.$handleEvent(a),t.choosethumb(a)}}})],1)]]:t._e(),[e("v-uni-image",{staticClass:"moment_img",style:{display:""==t.thumb?"none":"block"},attrs:{src:t.thumb},on:{click:function(a){a=t.$handleEvent(a),t.choosethumb(a)}}}),e("v-uni-view",{staticClass:"image",style:{display:0==t.hideAdd1?"none":"block"}},[e("v-uni-image",{staticClass:"moment_img",attrs:{src:t.$imgurl+"add.png"},on:{click:function(a){a=t.$handleEvent(a),t.choosethumb(a)}}})],1)]],2),e("v-uni-view",{staticClass:"row formtitle"},[t._v("产品组图")]),e("v-uni-view",{staticClass:"image_content formcon"},[t._l(t.imgs,function(a,i){return e("v-uni-view",{key:i,staticClass:"image"},[e("v-uni-image",{staticClass:"moment_img",attrs:{src:a}}),e("v-uni-view",{staticClass:"delimg",attrs:{"data-id":i},on:{click:function(a){a=t.$handleEvent(a),t.delimg(a)}}},[t._v("删除")])],1)}),e("v-uni-view",{staticClass:"image",style:{display:t.imgs.length>2?"none":"block"}},[e("v-uni-image",{staticClass:"moment_img",attrs:{src:t.$imgurl+"add.png"},on:{click:function(a){a=t.$handleEvent(a),t.chooseZutu(a)}}})],1)],2),e("v-uni-view",{staticClass:"row formtitle"},[t._v("售价")]),e("v-uni-view",{staticClass:"row formcon"},[t.proInfo.sellprice?[e("v-uni-input",{staticClass:"m-wrap placeholder-no-fix",attrs:{type:"digit",placeholder:"售价",name:"sellprice",value:t.proInfo.sellprice}})]:[e("v-uni-input",{staticClass:"m-wrap placeholder-no-fix",attrs:{type:"digit",placeholder:"售价",name:"sellprice"}})]],2),e("v-uni-view",{staticClass:"row formtitle"},[t._v("库存量")]),e("v-uni-view",{staticClass:"row formcon"},[t.proInfo.storage?[e("v-uni-input",{staticClass:"m-wrap placeholder-no-fix",attrs:{type:"number",placeholder:"库存量",name:"storage",value:t.proInfo.storage}})]:[e("v-uni-input",{staticClass:"m-wrap placeholder-no-fix",attrs:{type:"number",placeholder:"库存量",name:"storage"}})]],2),e("v-uni-view",{staticClass:"row formtitle"},[t._v("产品详情")]),e("v-uni-textarea",{staticClass:"textarea formcon",attrs:{name:"descp",placeholder:"产品详情",value:t.proInfo.descp}}),e("v-uni-button",{attrs:{"form-type":"submit"}},[t._v("确认发布/修改")])],1)],1):t._e()},n=[];e.d(a,"a",function(){return i}),e.d(a,"b",function(){return n})},"673e":function(t,a,e){"use strict";e("386b")("sub",function(t){return function(){return t(this,"sub","","")}})},"8b9c":function(t,a,e){"use strict";e.r(a);var i=e("4969"),n=e("27f6");for(var o in n)"default"!==o&&function(t){e.d(a,t,function(){return n[t]})}(o);e("fd49");var s=e("2877"),l=Object(s["a"])(n["default"],i["a"],i["b"],!1,null,"69c11954",null);a["default"]=l.exports},a882:function(t,a,e){var i=e("0c06");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=e("4f06").default;n("94a8ce64",i,!0,{sourceMap:!1,shadowMode:!1})},d2a7:function(t,a,e){"use strict";var i=e("288e");Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=i(e("f499"));e("a481"),e("673e");e("2f62");var o=e("2c90"),s={data:function(){return{$imgurl:this.$imgurl,needAuth:!1,needBind:!1,page_signs:"/pagesPluginShop/manage_pro/manage_pro",index:0,thumb:"",thumb_ok:"",id:"",hideAdd1:1,pagedata:[],host:"",video:"",cid:0,cateinfo:[],catelist:"",proInfo:"",imgs:[]}},onLoad:function(t){var a=this;this._baseMin(this),uni.setNavigationBarTitle({title:"商品详情"});var e=t.id?t.id:"";this.id=e;var i=0;o.h5login(i,function(){e>0?a._getProInfo(e):a.getcate()})},methods:{_getProInfo:function(t){var a=this;uni.request({url:a.$baseurl+"dopageshowShopPro",data:{id:t,uniacid:a.$uniacid,suid:uni.getStorageSync("suid")},success:function(t){t.data.data.images&&(a.pagedata=t.data.data.images),a.thumb_ok=t.data.data.thumb,a.thumb=t.data.data.thumb,a.proInfo=t.data.data,a.imgs=a.pagedata,a.pagedata=a.pagedata,a.cid=a.proInfo.cid,a.getcate(),console.log(a.thumb)}})},getcate:function(){var t=this;uni.request({url:t.$baseurl+"doPageGetGoodsCate",data:{uniacid:t.$uniacid,id:t.id},success:function(a){t.id;var e=a.data.data.arr,i=a.data.data.index;t.cateinfo=e,t.index=i,t.catelist=a.data.data.list}})},bindPickerChange:function(t){var a=this,e=t.detail.value;if(e>0)var i=e-1;for(var n=a.catelist,o=0,s=0,l=0;l<n.length;l++)if(0==l)i==l?s=n[l]["id"]:i<n[l]["sub"].length+1&&(s=n[l]["sub"][i-1]["id"]);else if(o+=n[l]["sub"].length+1,i<o+n[0]["sub"].length+1)for(var c=0,u=o+n[0]["sub"].length+1-n[l]["sub"].length-1;u<o+n[0]["sub"].length+1;u++)u==i&&(s=0==c?n[l]["id"]:n[l]["sub"][c-1]["id"]),c+=1;a.index=e,a.cid=s},choosethumb:function(){var t=this,a=t.$baseurl+"wxupimg";uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){uni.showLoading({title:"图片上传中"});var i=e.tempFilePaths;uni.uploadFile({url:a,formData:{uniacid:t.$uniacid},filePath:i[0],name:"file",success:function(a){var e=a.data;t.thumb=e,t.thumb_ok=e,t.hideAdd1=0,uni.hideLoading()}})}})},chooseZutu:function(){var t=this;uni.chooseImage({count:3,sizeType:["original"],sourceType:["album","camera"],success:function(a){a.tempFilePaths.length>0&&t._uploadImg(a.tempFilePaths,1,function(a){console.log(a);var e=t.host+a,i=t.pagedata;i.push(e),console.log(i),t.pagedata.length>2?(t.hideAdd=0,t.imgs=t.pagedata):(t.hideAdd=1,t.imgs=i),t.pagedata=i,console.log(t.pagedata)})}})},_uploadImg:function(t,a,e){var i=this;if(2==a)uni.uploadFile({url:i.$baseurl+"wxupimg",formData:{uniacid:i.$uniacid},filePath:t,name:"file",success:function(t){console.log("上传成功"),console.log(t),"function"==typeof e&&e(t.data)},fail:function(t){uni.showModal({title:"错误提示",content:"上传失败",showCancel:!1})}});else for(var n=0;n<t.length;n++)uni.uploadFile({url:i.$baseurl+"wxupimg",formData:{uniacid:i.$uniacid},filePath:t[n],name:"file",success:function(t){console.log("上传成功"),"function"==typeof e&&e(t.data)},fail:function(t){uni.showModal({title:"错误提示",content:"上传失败",showCancel:!1})}})},getBLen:function(t){return null==t?0:("string"!=typeof t&&(t+=""),t.replace(/[^\x00-\xff]/g,"01").length)},delimg:function(t){var a=this,e=t.currentTarget.dataset.id,i=a.pagedata;i.splice(e,1),a.imgs=i,a.pagedata=i},isInt:function(t){var a=/^\d+(?=\.{0,1}\d+$|$)/;return!!a.test(t)},formSubmit:function(t){var a=this,e=t.detail.value,i=a.cid;return 0==i?(uni.showModal({title:"提示",content:"请选择所属栏目",showCancel:!1}),!1):""==e["title"]?(uni.showModal({title:"提示",content:"请输入商品标题",showCancel:!1}),!1):a.getBLen(e.title)>100?(uni.showModal({title:"提示",content:"商品标题最多输入50个汉字",showCancel:!1}),!1):""==a.thumb_ok?(uni.showModal({title:"提示",content:"请上传商品缩略图",showCancel:!1}),!1):a.pagedata.length<1?(uni.showModal({title:"提示",content:"请至少上传一张商品组图",showCancel:!1}),!1):""==e["sellprice"]?(uni.showModal({title:"提示",content:"请输入商品售价",showCancel:!1}),!1):a.isInt(e.sellprice)?""==e["storage"]?(uni.showModal({title:"提示",content:"请输入商品库存",showCancel:!1}),!1):(console.log(989898989),console.log(a.pagedata),console.log((0,n.default)(a.pagedata)),void uni.request({url:a.$baseurl+"dopageaddPro",data:{title:e.title,num:e.num,pageview:e.pageview,buy_type:0,flag:0==e.flag?1:e.flag,kuaidi:0,rsales:e.rsales,sellprice:e.sellprice,marketprice:e.marketprice,storage:e.storage,descp:e.descp,images:(0,n.default)(a.pagedata),thumb:a.thumb,sid:uni.getStorageSync("mlogin"),id:a.id,uniacid:a.$uniacid,cid:a.cid},success:function(t){0==t.data.data?uni.showModal({title:"提示",content:"添加失败",showCancel:!1}):(uni.showToast({title:"添加/修改成功",icon:"success"}),setTimeout(function(){uni.redirectTo({url:"/pagesPluginShop/manage_prolist/manage_prolist"})},1e3))}})):(uni.showModal({title:"提示",content:"商品售价应为正数",showCancel:!1}),!1)}}};a.default=s},fd49:function(t,a,e){"use strict";var i=e("a882"),n=e.n(i);n.a}}]);